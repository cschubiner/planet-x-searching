/* Copy Bootstrap's `bg-*`, but with purple instead */
.bg-purple {
  --bs-bg-opacity: 1;
  /* This is slightly different because Bootstrap doesn't provide the RGB of
     `--bs-purple`. */
  background-color: var(--bs-purple) !important;
}

/* Copy Bootstrap's `btn-*`, but with purple instead */
/* not used */
.btn-purple {
  --bs-btn-color: #fff;
  --bs-btn-bg: var(--bs-purple);
  --bs-btn-border-color: var(--bs-purple);
  --bs-btn-hover-color: #fff;
  --bs-btn-hover-bg: var(--bs-indigo);
  --bs-btn-hover-border-color: var(--bs-indigo);
  --bs-btn-active-color: #fff;
  --bs-btn-active-bg: var(--bs-indigo);
  --bs-btn-active-border-color: var(--bs-indigo);
  --bs-btn-disabled-color: #fff;
  --bs-btn-disabled-bg: var(--bs-purple);
  --bs-btn-disabled-border-color: var(--bs-purple);
}

/* Copy Bootstrap's `btn-outline-*`, but with purple instead */
.btn-outline-purple {
  --bs-btn-color: var(--bs-purple);
  --bs-btn-border-color: var(--bs-purple);
  --bs-btn-hover-color: #fff;
  --bs-btn-hover-bg: var(--bs-purple);
  --bs-btn-hover-border-color: var(--bs-purple);
  --bs-btn-active-color: #fff;
  --bs-btn-active-bg: var(--bs-purple);
  --bs-btn-active-border-color: var(--bs-purple);
  --bs-btn-disabled-color: var(--bs-purple);
  --bs-btn-disabled-bg: transparent;
  --bs-btn-disabled-border-color: var(--bs-purple);
  --bs-gradient: none;
}

.game-settings-col {
  min-width: 140px;
}

img {
  width: 25px;
  height: 25px;
}

img.small-object {
  width: 20px;
  height: 20px;
}

img.time {
  width: 15px;
  height: 15px;
  position: relative;
  top: -2px;
}

.small-col {
  width: 0;
  white-space: nowrap;
}

/* Since we wanted to freeze the first two columns of `#hints-table`, we had to
   make the background opaque. To make the table borders follow the frozen
   columns, we had to separate the borders and make sure they didn't double up
   between cells (so not using `.table-bordered`). */
#hints-table {
  --bs-table-bg: var(--bs-white);
  border-collapse: separate;
  border-spacing: 0;
}

#hints-table .hint-cell.table-secondary {
  background-color: #b9c0c9;
}

#hints-table > * > :first-child > :first-child {
  /* First cell: full border */
  border-width: 1px;
}

#hints-table > * > :first-child > :not(:first-child) {
  /* Cells in the first row: right, top, and bottom border */
  border-width: 1px 1px 1px 0;
}

#hints-table > * > :not(:first-child) > :first-child {
  /* First cell of each row: left, right, and bottom border */
  border-width: 0 1px 1px 1px;
}

#hints-table > * > :not(:first-child) > :not(:first-child) {
  /* All cells: right and bottom border */
  border-width: 0 1px 1px 0;
}

.freeze-col {
  position: sticky;
  left: 0;
  /* Increase the z-index so that other elements don't appear over the frozen
     columns. */
  z-index: 1000;
}

/* First column of hints table */
#hints-table > tbody > tr > :first-child {
  text-align: left;
}

textarea {
  resize: none;
}

[contenteditable] {
  text-align: start;
  width: 100%;
  height: 100%;
}

[contenteditable]:empty:before {
  content: attr(placeholder);
  color: gray;
  cursor: text;
}

.research-table-col {
  /* Exactly enough so that the dropdowns fit with the perfect padding. */
  min-width: 347px;
}

.moves-table-col {
  /* Exactly enough to fix the survey objects with the perfect padding. */
  min-width: 268px;
}

.action-btn-grid.btn-group {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 0;
  max-width: 180px;
  width: 100%;
}

.action-btn-grid label.btn {
  aspect-ratio: 1 / 1;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 0.35rem;
  font-size: 0.75rem;
  line-height: 1.1;
  white-space: normal;
  border-radius: 0;
}

.action-btn-grid label.btn:nth-of-type(1) {
  border-top-left-radius: 0.375rem;
}

.action-btn-grid label.btn:nth-of-type(2) {
  border-top-right-radius: 0.375rem;
  border-left-width: 0;
}

.action-btn-grid label.btn:nth-of-type(3) {
  border-bottom-left-radius: 0.375rem;
  border-top-width: 0;
}

.action-btn-grid label.btn:nth-of-type(4) {
  border-bottom-right-radius: 0.375rem;
  border-top-width: 0;
  border-left-width: 0;
}

.action-btn-grid.is-invalid {
  outline: 2px solid var(--bs-danger);
  outline-offset: 2px;
  border-radius: 0.5rem;
}

.action-btn-grid.is-invalid + .invalid-feedback {
  display: block;
}

/* Text color for purple player */
.text-purple {
  color: var(--bs-purple) !important;
}

/* Time track section */
#time-track-section {
  padding: 0.5rem;
  background-color: var(--bs-light);
  border-radius: 0.375rem;
}

#time-track-display .badge {
  font-size: 0.9rem;
  padding: 0.4rem 0.6rem;
}

/* Tutorial Styles */
.tutorial-object-img {
  width: 40px;
  height: 40px;
  margin-bottom: 0.25rem;
}

.tutorial-inline-img {
  width: 20px;
  height: 20px;
  vertical-align: middle;
}

#tutorial-modal .modal-body {
  min-height: 350px;
}

#tutorial-modal .alert {
  margin-bottom: 1rem;
}

#tutorial-modal h4 {
  color: var(--bs-info);
  margin-bottom: 1rem;
}

#tutorial-modal h5 {
  margin-top: 1rem;
  margin-bottom: 0.5rem;
}

#tutorial-modal .card {
  height: 100%;
  border-left: 3px solid var(--bs-info);
}

#tutorial-progress {
  font-weight: 500;
  color: var(--bs-secondary);
}

/* Ensure tutorial modal buttons are clickable */
#tutorial-modal .modal-footer {
  position: relative;
  z-index: 1;
}

#tutorial-modal .modal-footer button {
  position: relative;
  z-index: 2;
}

/* Section help icons */
.section-help {
  font-size: 0.7em;
  vertical-align: middle;
  cursor: help;
  opacity: 0.7;
  transition: opacity 0.2s;
  position: relative;
  z-index: 2;
  pointer-events: auto;
}

.section-help:hover {
  opacity: 1;
}

/* First-time user highlight animation */
@keyframes pulse-highlight {
  0% {
    box-shadow: 0 0 0 0 rgba(13, 202, 240, 0.4);
  }
  70% {
    box-shadow: 0 0 0 10px rgba(13, 202, 240, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(13, 202, 240, 0);
  }
}

.tutorial-highlight {
  animation: pulse-highlight 2s infinite;
}

/* Tutorial button styling */
#tutorial-btn {
  vertical-align: middle;
}

/* ========== Circular Board Styles ========== */
#circular-board-container {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
  border-radius: 1rem;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  overflow: hidden;
}

#circular-board {
  position: relative;
  width: 320px;
  height: 320px;
  border-radius: 50%;
  background: radial-gradient(circle at center, #0d1b2a 0%, #1b263b 60%, #415a77 100%);
  box-shadow:
    inset 0 0 60px rgba(0, 0, 0, 0.5),
    0 0 30px rgba(100, 150, 255, 0.2);
  transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

@media (min-width: 576px) {
  #circular-board {
    width: 400px;
    height: 400px;
  }
}

@media (min-width: 768px) {
  #circular-board {
    width: 450px;
    height: 450px;
  }
}

/* Center sun and info */
#board-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ffd700, #ff8c00, #ff4500);
  box-shadow:
    0 0 30px rgba(255, 200, 0, 0.6),
    0 0 60px rgba(255, 150, 0, 0.4),
    inset 0 0 20px rgba(255, 255, 200, 0.3);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10;
  animation: sun-pulse 4s ease-in-out infinite;
}

@keyframes sun-pulse {
  0%, 100% {
    box-shadow:
      0 0 30px rgba(255, 200, 0, 0.6),
      0 0 60px rgba(255, 150, 0, 0.4);
  }
  50% {
    box-shadow:
      0 0 40px rgba(255, 200, 0, 0.8),
      0 0 80px rgba(255, 150, 0, 0.5);
  }
}

#center-sun {
  font-size: 1.5rem;
  color: #fff;
  text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
}

#center-info {
  display: none;
  flex-direction: column;
  align-items: center;
  text-align: center;
  color: #fff;
  font-size: 0.7rem;
  font-weight: bold;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

#center-info.active {
  display: flex;
}

#center-info.active + #center-sun {
  display: none;
}

#board-center:has(#center-info.active) #center-sun {
  display: none;
}

#center-sector-num {
  font-size: 1.2rem;
  line-height: 1;
}

#center-object-name {
  font-size: 0.6rem;
  opacity: 0.9;
}

/* Visible sky indicator */
#visible-sky-indicator {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  pointer-events: none;
  z-index: 1;
  opacity: 0;
  transition: opacity 0.3s ease;
}

#visible-sky-indicator.active {
  opacity: 1;
}

/* Sector styling */
.sector {
  position: absolute;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 5;
  background: linear-gradient(145deg, #2d3a4a, #1e2632);
  border: 2px solid #4a5568;
  box-shadow:
    0 4px 15px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

@media (min-width: 576px) {
  .sector {
    width: 58px;
    height: 58px;
  }
}

@media (min-width: 768px) {
  .sector {
    width: 65px;
    height: 65px;
  }
}

.sector:hover {
  transform: scale(1.15);
  z-index: 20;
  box-shadow:
    0 8px 25px rgba(0, 0, 0, 0.4),
    0 0 20px rgba(100, 200, 255, 0.3);
}

.sector.adjacent-highlight {
  border-color: #00bcd4;
  box-shadow:
    0 0 15px rgba(0, 188, 212, 0.5),
    0 4px 15px rgba(0, 0, 0, 0.3);
  animation: adjacent-pulse 1s ease-in-out infinite;
}

@keyframes adjacent-pulse {
  0%, 100% { box-shadow: 0 0 15px rgba(0, 188, 212, 0.5); }
  50% { box-shadow: 0 0 25px rgba(0, 188, 212, 0.8); }
}

.sector.selected {
  border-color: #fff;
  box-shadow:
    0 0 20px rgba(255, 255, 255, 0.5),
    0 8px 25px rgba(0, 0, 0, 0.4);
}

/* Sector number */
.sector-number {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  background: #1a1a2e;
  color: #a0aec0;
  font-size: 0.65rem;
  font-weight: bold;
  padding: 1px 5px;
  border-radius: 8px;
  border: 1px solid #4a5568;
  z-index: 2;
}

.sector:hover .sector-number {
  background: #4a5568;
  color: #fff;
}

/* Sector content */
.sector-content {
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
}

@media (min-width: 576px) {
  .sector-content {
    width: 35px;
    height: 35px;
  }
}

.sector-content img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.sector-content .bi {
  font-size: 1.2rem;
  color: #718096;
}

/* Sector states */
.sector.unknown {
  background: linear-gradient(145deg, #2d3a4a, #1e2632);
  border-color: #4a5568;
}

.sector.confirmed {
  background: linear-gradient(145deg, #1e4d2b, #0d3319);
  border-color: #48bb78;
  box-shadow:
    0 4px 15px rgba(0, 0, 0, 0.3),
    0 0 15px rgba(72, 187, 120, 0.3);
}

.sector.confirmed .sector-number {
  background: #1e4d2b;
  border-color: #48bb78;
  color: #9ae6b4;
}

.sector.ruled-out {
  background: linear-gradient(145deg, #4a2020, #2d1515);
  border-color: #9b2c2c;
  opacity: 0.7;
}

.sector.ruled-out .sector-number {
  background: #4a2020;
  border-color: #9b2c2c;
  color: #fc8181;
}

.sector.planet-x-found {
  background: linear-gradient(145deg, #744210, #5a3510);
  border-color: #ecc94b;
  animation: planet-x-glow 2s ease-in-out infinite;
}

@keyframes planet-x-glow {
  0%, 100% {
    box-shadow:
      0 0 20px rgba(236, 201, 75, 0.5),
      0 0 40px rgba(236, 201, 75, 0.3);
  }
  50% {
    box-shadow:
      0 0 30px rgba(236, 201, 75, 0.7),
      0 0 60px rgba(236, 201, 75, 0.5);
  }
}

.sector.planet-x-found .sector-number {
  background: #744210;
  border-color: #ecc94b;
  color: #faf089;
}

/* Visible sky highlight */
.sector.in-visible-sky {
  opacity: 1;
}

.sector.not-in-visible-sky {
  opacity: 0.4;
  filter: brightness(0.6);
}

/* Prime sector indicator (for comets) */
.sector.prime-sector::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 50%;
  transform: translateX(-50%);
  width: 6px;
  height: 6px;
  background: #9f7aea;
  border-radius: 50%;
  box-shadow: 0 0 6px rgba(159, 122, 234, 0.8);
}

/* Board legend */
#board-legend {
  color: #a0aec0;
}

#board-legend .badge {
  font-weight: normal;
}

/* Rotation animation */
#circular-board.rotating {
  transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Sector entry animation */
@keyframes sector-appear {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

.sector.animate-in {
  animation: sector-appear 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

/* Orbit rings (decorative) */
#circular-board::before,
#circular-board::after {
  content: '';
  position: absolute;
  border-radius: 50%;
  border: 1px dashed rgba(100, 150, 200, 0.2);
  pointer-events: none;
}

#circular-board::before {
  top: 25%;
  left: 25%;
  width: 50%;
  height: 50%;
}

#circular-board::after {
  top: 10%;
  left: 10%;
  width: 80%;
  height: 80%;
}

/* Stars background effect */
#circular-board-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image:
    radial-gradient(2px 2px at 20px 30px, rgba(255, 255, 255, 0.3), transparent),
    radial-gradient(2px 2px at 40px 70px, rgba(255, 255, 255, 0.2), transparent),
    radial-gradient(1px 1px at 90px 40px, rgba(255, 255, 255, 0.4), transparent),
    radial-gradient(2px 2px at 130px 80px, rgba(255, 255, 255, 0.2), transparent),
    radial-gradient(1px 1px at 160px 120px, rgba(255, 255, 255, 0.3), transparent);
  border-radius: 1rem;
  pointer-events: none;
  animation: twinkle 4s ease-in-out infinite;
}

@keyframes twinkle {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

/* Player pawns on circular board */
.player-pawn {
  position: absolute;
  width: 28px;
  height: 28px;
  transform: translate(-50%, -50%);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 30;
  cursor: help;
}

.player-pawn-inner {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: bold;
  color: white;
  border: 2px solid rgba(255, 255, 255, 0.3);
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.4),
    0 0 0 2px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
}

.player-pawn-active .player-pawn-inner {
  border-color: white;
  border-width: 3px;
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.5),
    0 0 15px rgba(255, 255, 255, 0.5);
  animation: pawn-pulse 2s ease-in-out infinite;
}

@keyframes pawn-pulse {
  0%, 100% {
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.5),
      0 0 15px rgba(255, 255, 255, 0.5);
  }
  50% {
    box-shadow:
      0 4px 15px rgba(0, 0, 0, 0.6),
      0 0 25px rgba(255, 255, 255, 0.7);
  }
}

.player-pawn:hover .player-pawn-inner {
  transform: scale(1.2);
}

/* ========== Theory Progress Tracking Styles ========== */

.theory-progress-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0.25rem;
}

.theory-progress-track {
  margin-bottom: 0.25rem;
}

.theory-progress-dot {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  display: inline-block;
  transition: all 0.3s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

.theory-progress-dot.current {
  transform: scale(1.3);
  box-shadow: 0 0 8px currentColor;
}

.theory-progress-dot.bg-info {
  box-shadow: 0 0 6px rgba(13, 202, 240, 0.5);
}

.theory-progress-dot.bg-warning {
  box-shadow: 0 0 6px rgba(255, 193, 7, 0.5);
}

.theory-progress-dot.bg-danger {
  box-shadow: 0 0 6px rgba(220, 53, 69, 0.5);
}

.theory-progress-dot.current.bg-info {
  box-shadow: 0 0 12px rgba(13, 202, 240, 0.8);
  animation: pulse-info 1.5s ease-in-out infinite;
}

.theory-progress-dot.current.bg-warning {
  box-shadow: 0 0 12px rgba(255, 193, 7, 0.8);
  animation: pulse-warning 1.5s ease-in-out infinite;
}

.theory-progress-dot.current.bg-danger {
  box-shadow: 0 0 12px rgba(220, 53, 69, 0.8);
  animation: pulse-danger 1.5s ease-in-out infinite;
}

@keyframes pulse-info {
  0%, 100% { box-shadow: 0 0 8px rgba(13, 202, 240, 0.5); }
  50% { box-shadow: 0 0 16px rgba(13, 202, 240, 0.9); }
}

@keyframes pulse-warning {
  0%, 100% { box-shadow: 0 0 8px rgba(255, 193, 7, 0.5); }
  50% { box-shadow: 0 0 16px rgba(255, 193, 7, 0.9); }
}

@keyframes pulse-danger {
  0%, 100% { box-shadow: 0 0 8px rgba(220, 53, 69, 0.5); }
  50% { box-shadow: 0 0 16px rgba(220, 53, 69, 0.9); }
}

.theory-progress-connector {
  width: 16px;
  height: 3px;
  background-color: var(--bs-secondary);
  opacity: 0.25;
  display: inline-block;
  border-radius: 2px;
  transition: all 0.3s ease;
}

.theory-progress-connector.active {
  opacity: 1;
  background: linear-gradient(90deg, var(--bs-info), var(--bs-warning));
}

.theory-progress-badge {
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  white-space: nowrap;
}

/* Highlight row animation when theory reaches peer review */
.theory-row.table-danger {
  animation: peer-review-alert 0.5s ease-in-out;
}

@keyframes peer-review-alert {
  0%, 100% { background-color: inherit; }
  50% { background-color: rgba(220, 53, 69, 0.3); }
}

/* Advance button styling */
#advance-theories-btn {
  transition: all 0.3s ease;
}

#advance-theories-btn:hover {
  transform: scale(1.05);
}

#advance-theories-btn.btn-success {
  animation: advance-success 0.3s ease;
}

@keyframes advance-success {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

/* Pulsing highlight for Advance Theories button when theory phase is pending */
#advance-theories-btn.theory-phase-pending {
  animation: theory-phase-pulse 1s ease-in-out infinite;
  box-shadow: 0 0 15px rgba(13, 110, 253, 0.5);
}

@keyframes theory-phase-pulse {
  0%, 100% {
    box-shadow: 0 0 10px rgba(13, 110, 253, 0.4);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 25px rgba(13, 110, 253, 0.8);
    transform: scale(1.08);
  }
}
